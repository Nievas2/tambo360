generator client {
  provider = "prisma-client"
  output   = "../src/generated/prisma"
}

datasource db {
  provider = "postgresql"
}

model Usuario {
  idUsuario        String            @id @default(uuid())
  correo           String            @unique
  contrasena       String
  nombre           String
  fechaCreacion    DateTime          @default(now())
  establecimientos Establecimiento[]
}

model Establecimiento {
  idEstablecimiento String           @id @default(uuid())
  nombre            String
  localidad         String
  provincia         String
  fechaCreacion     DateTime         @default(now())
  idUsuario         String
  usuario           Usuario          @relation(fields: [idUsuario], references: [idUsuario])
  loteProducciones  LoteProduccion[]
}

enum Unidad {
  kg
  litros
}

enum Moneda {
  USD
  EUR
  ARS
}

enum Categoria {
  quesos
  leches 
}

model Producto {
  idProducto String @id @default(uuid())
  nombre     String
  categoria   Categoria
  loteProducciones LoteProduccion[]
}

model LoteProduccion {
  idLote            String          @id @default(uuid())
  fechaProduccion   DateTime        @default(now())
  idProducto        String
  producto          Producto        @relation(fields: [idProducto], references: [idProducto])
  cantidad          Float
  unidad            Unidad
  idEstablecimiento String
  establecimiento   Establecimiento @relation(fields: [idEstablecimiento], references: [idEstablecimiento])
  mermas            Merma[]
  costosDirectos    CostosDirecto[]
}

model Merma {
  idMerma       String         @id @default(uuid())
  descripcion   String
  cantidad      Float
  unidad        Unidad
  fechaCreacion DateTime       @default(now())
  idLote        String
  lote          LoteProduccion @relation(fields: [idLote], references: [idLote])
}

model CostosDirecto {
  idCostoDirecto String         @id @default(uuid())
  concepto       String
  monto          Decimal
  moneda         Moneda
  fechaCreacion  DateTime       @default(now())
  idLote         String
  lote           LoteProduccion @relation(fields: [idLote], references: [idLote])
}
